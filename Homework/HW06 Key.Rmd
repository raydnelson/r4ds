---
title: 'Homework #6 Key'
author: "Select, Mutate, and Rename"
date: "Due: 2 Feb 2021"
output:
  html_document:
    code_folding: hide
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE)
library(tidyverse)
library(nycflights13)
```

## Concepts  

1.  Compare and contrast filter and select.  

Filter is used to choose rows and select is used to choose columns.  

2.  Explain how ":" can be used when selecting variables.  

In R, the ":" symbol generates a range of values. For example, 1:5 gives the numbers 1, 2, 3, 4, 5. You can also select a range of variables. For example, if we have a sequence of contiguous variables in a data frame like A1, A2, and A3, we can reference them as A1:A3.

## Interpretation of code  

```{r code chunk interpretation}
flights %>%
  mutate(
    hours = dep_time %/% 100,
    minutes = dep_time %% 100,
    minutes_after_midnight = 60 * hours + minutes
  ) %>%
  ggplot(aes(y = origin,
             x = minutes_after_midnight,
             fill = origin)) +
  geom_boxplot(show.legend = FALSE)
```

The first 6 lines of code create a new tibble with converted times:
*  The first calculation in the mutate function determines the number of hours from dep_time by using %/% in division of two integers. In this case, we throw away the remainder.
*  The second calculation, dep_time %% 100, determines the number of minutes as the modulus or remainder of integer division.
*  Finally, we calculate a new variable minutes_after_midnight which is the number of hours multiplied by 60 plus the number of minutes from the remainder.    

The next 4 lines draw a boxplot based on the new data frame that was created in the first six lines of code.  

*  The mapping assigns the category origin to y and minutes_after_midnight to x. The fill in all successive geometric objects or layers is mapped to the origin.
*  We suppress the legend for the boxplot layer because labeling is inherent in a boxplot.


## Write your own code

1.  Select only those flights going from JFK to Chicago (ORD).
1.  Include the following variables: dep_delay and arr_delay. 
1.  Rename the variables dep_delay to departure and arr_delay to arrival.
1.  Draw a scatterplot of arrival on departure with colored loess and linear regression smoothers without confidence intervals.


```{r JFK to Chicago}
flights %>% 
  filter(origin == "JFK", dest == "ORD") %>% 
  select(dep_delay, arr_delay) %>% 
  rename(departure = dep_delay,
         arrival = arr_delay) %>% 
  ggplot(aes(x = departure, y = arrival)) +
  geom_point() +
  geom_smooth(color = "red", se = FALSE) +
  geom_smooth(method = "lm", color = "blue", se = FALSE)
```  

## Extra Coding Problem **(optional)**

Use mutate and the ranking function to find the 5 most delayed flights departing from JFK.

1. Choose the flights departing from JFK
1. Create a new variable called delay which is the rank of the departure delay with 1 being the longest delay.
1. For the five most delayed flights, print the new variable delay along with origin, year, month, day, dest, carrier, and dep_delay with the most delayed at the top of the table.  

```{r 5 most delayed flights}
flights %>% 
  filter(origin == "JFK") %>% 
  mutate(delay = dep_delay %>% desc() %>% min_rank()) %>% 
  arrange(delay) %>% 
  select(year, month, day, carrier, dep_delay) %>% 
  head(5)
```  

