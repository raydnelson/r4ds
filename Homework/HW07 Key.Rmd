---
title: 'Homework #7 Key'
author: 'Summarization by Group'
date: "Due: 30 Sep 2019"
output:
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(nycflights13)
```

## Concepts  

Carefully explain the following:  

1.  The two elements that define the distribution of a random variable  

The two elements that define a distribution are all of the possible values that the variable can assume and the frequency at which they occur. The frequency is often interpreted as a probability. We often refer to the distribution of a variable as a pdf (probability distribution function or probability density function).  

2.  How the mean measures the location of a distribution  

The mean of a variable gives its center of gravity or the balance point. If we put a fulcrum at the mean, then the distribution would exactly balance. The mean is the most frequently used measure of central tendency. The mean is the sum of the observations in a sample divided by the sample size.  

3.  How the standard deviation measures the scale or spread of a distribution  

The standard deviation attempts to measure the average size of deviations. A deviation is defined as the distance of an observation from the mean. We can't simply add up the deviations because the sum of the deviations in a sample is always zero. The negative and positive deviations cancel each other out. For this reason we have to square the deviations. We then average these squared deviations and take the square root to get the standard deviation. The standard deviation has the units of the original observations.

## Interpretation 

Interpret the following R code:  

```{r code chunk interpretation}
flights %>%
  group_by(day, month) %>%
  summarize(cancelled = mean(is.na(dep_time)) * 100,
            delay = mean(dep_delay, na.rm = TRUE)) %>%
  ggplot(aes(x = delay, y = cancelled)) +
  geom_point() +
  geom_smooth(color = "red")
```

Lines 1 - 2: group the observations in the flights data set by day and month. Although R doesn't actually sort the observations, the subsequent calcuations act as though all of the observations have first been sorted by month and then by day.  

Lines 3: calculate proportion of cancelled flights. The term is.na(dep_time) creates a logical variable. If dep_time is missing, then the expression evaluates as true and receives a value of one. If dep_time isn't missing, then the expression evaluates as false and receives a value of zero. Summing the logical variable gives the number of cancelled flights. Calculating the mean gives the proportion of cancelled flights. Multiplying by 100 converts the proportion into a percentage.  

Line 4: calculates the average delay after removing missing values with the na.rm function.  

Line 5: puts the average delay on the x axis and the percentage of cancelled flights on the y axis  

Lines 6 - 7: creates a scatterplot using the geom_point with a loess smoothed line that results from the geom_smooth  

The remainder of the code creates the labels on the graph. 

## Coding Problems

1.  Create a new data frame that excludes cancelled flights

```{r exclude cancelled flights}
not_cancelled <- flights %>% 
  filter(!is.na(dep_delay)) %>% 
  filter(!is.na(arr_delay))
```  

This data frame should have 327346 observations.

2.  For the not cancelled flights, rank carriers from best to worst by their average arrival delays. Count the number of flights for each carrier.

```{r carrier ranking}
not_cancelled %>%
  group_by(carrier) %>% 
  summarise(
    average_arrival_delay = mean(arr_delay),
    flights = n()
  ) %>% 
  arrange(average_arrival_delay)
```  

3.  For the not cancelled flights, rank carriers from best to worst by their on time percentage as measured by the arrival delay. Count the number of flights for each carrier.

```{r time percentage}
not_cancelled %>% 
  group_by(carrier) %>% 
  summarise(
    on_time_percentage = mean(arr_delay <= 0),
    flights = n()) %>% 
  arrange(on_time_percentage %>% desc())
```

